<%= form_for [@log, @log_entry] do |f| %>
<%= render 'layouts/form_errors', :errors => {:log_entry => @log_entry.errors} if @log_entry.errors.any? %>
<div class="clearfix">
  <div class="col-md-7 well well-lg">

    <% if @bandplan %>
      <div class="alert alert-success">
        <h3>
          <span class="glyphicon glyphicon-info-sign"></span>
          <%= @bandplan.description %>
        </h3>
        Częstotliwości <%= @bandplan.purpose %>. Pełny zakres częstotliwości dla tego pasma zawiera się w przedziale <%= format_mhz @bandplan.mhz_start  %> MHz i <%= format_mhz @bandplan.mhz_end %> MHz
      </div>
    <% end %>

    <% if @stations.any? %>
      <ul class="list-group hidden-xs">
        <li class="list-group-item list-group-item-default">
          <div class="row">
            <div class="col-md-1"><h4 class="list-group-item-heading">Typ</h4></div>
            <div class="col-md-4"><h4 class="list-group-item-heading">Operator</h4></div>
            <div class="col-md-4"><h4 class="list-group-item-heading">Stacja</h4></div>
            <div class="col-md-2"><h4 class="list-group-item-heading">Odległość</h4></div>
            <div class="col-md-1"></div>
          </div>
        </li>
      </ul>
      <ul class="list-group" id="log_entry_related_frequency_assignment_state">


      <% @stations.each do |station| %>
        <li class="list-group-item radio-select-element" data-radio-select-state-element-selector="#log_entry_related_frequency_assignment_state" data-radio-select-element-selector="#log_entry_related_frequency_assignment_id_<%= station[:frequency_assignment_id] %>">
          <div class="row">
            <div class="col-md-1"><%= station_net_to_icon station[:net], :h2 %></div>
            <div class="col-md-4"><%= station[:owner] %></div>
            <div class="col-md-4"><%= station[:display_name] %></div>
            <div class="col-md-2"><span class="label label-<%= log_entries_distance_marker(station[:distance].to_f, station[:radius].to_f) %>"><%= station[:distance].to_f.round(2) %>km</span></div>
            <div class="col-md-1"><%= f.radio_button :related_frequency_assignment_id, station[:frequency_assignment_id], data: {geocode: true, lat: station[:lat], lon: station[:lon]} %></div>
          </div>
        </li>
      <% end %>
      </ul>

    <% else %>
      <%= bootstrap_info do %>
        Nie znalazłem w bazie danych żadnych częstotliwości powiązanych z <%= @log_entry.mhz %> MHz. Nie jest to oczywiście błędem, w bazie są nie znajdziesz częstotliwości
        służb - nie mniej jednak możesz je dodawać na prywatny użytek.
      <% end %>
      <div id="map-canvas"></div>
    <% end %>

  </div>
  <div class="col-md-4 col-md-offset-1 well well-lg">
    <div class="form-group">
      <label class="control-label" for="log_entry_mhz">Dziennik</label>
      <input class="form-control input-lg" readonly="readonly" type="text" value="<%= @log.name %>">
    </div>

    <div class="form-group">
      <%= f.label :mhz, class: 'control-label' %>
      <%= f.text_field :mhz, class: 'form-control input-lg', readonly: true %>
    </div>

    <div class="form-group">
      <%= f.label :description, class: 'control-label' %>
      <%= f.text_area :description, class: 'form-control input-lg' %>
    </div>

    <div class="form-group" id="log_entry_net_state">
      <%= f.label :net, class: 'control-label' %>
      <div class="clearfix">
        <% Uke::Net::listenable.each do |net| %>
            <div class="thumbnail h1-glyphicon-container pull-left radio-select-element" data-radio-select-state-element-selector="#log_entry_net_state" data-radio-select-element-selector="#log_entry_net_<%= net.downcase %>">
              <%= station_net_to_icon net, :h1 %>
              <div class="caption">
                <%= f.radio_button :net, net %>
              </div>
            </div>

        <% end %>
      </div>
    </div>

    <div class="form-group">
      <%= f.label :level, class: 'control-label' %>
      <p class="text-muted"><small>1 - nieczytelny, 5 - doskonały</small></p>
      <%= f.select :level, ([5, 4, 3, 2, 1].map {|n| [n, n] }), {}, {class: 'form-control input-lg'} %>
    </div>

    <div class="form-group">
      <%= link_to 'Anuluj', @log, class: 'btn btn-danger btn-lg' %>
      <%= f.submit class: 'btn btn-primary btn-lg' %>
    </div>

    <p class="text-muted"><small>
      <br />
      Poniższe pola uzupełniają się automatycznie. Zaznacz stację z listy, lub użyj mapy: chwyć i przeciągnij kursor w miejsce, gdzie Twoim zdaniem
      znajduje się źródło częstotliwości. Możesz wybrać przybliżoną lokalizację, eg. wybrać centrum miasta.
    </small></p>

    <div class="form-group">
      <%= f.label :street_address, class: 'control-label' %>
      <%= f.text_field :street_address, class: 'form-control input-lg', readonly: true %>
    </div>
    <div class="form-group">
      <%= f.label :administrative_area_level_3, class: 'control-label' %>
      <%= f.text_field :administrative_area_level_3, class: 'form-control input-lg', readonly: true %>
    </div>
    <div class="form-group">
      <%= f.label :administrative_area_level_2, class: 'control-label' %>
      <%= f.text_field :administrative_area_level_2, class: 'form-control input-lg', readonly: true %>
    </div>
    <div class="form-group">
      <%= f.label :administrative_area_level_1, class: 'control-label' %>
      <%= f.text_field :administrative_area_level_1, class: 'form-control input-lg', readonly: true %>
    </div>
    <div class="form-group">
      <%= f.label :country, class: 'control-label' %>
      <%= f.text_field :country, class: 'form-control input-lg', readonly: true %>
    </div>

    <div class="row">
      <div class="form-group col-md-6">
        <%= f.label :lat, class: 'control-label' %>
        <%= f.text_field :lat, class: 'form-control input-lg', readonly: true %>
      </div>

      <div class="form-group col-md-6">
        <%= f.label :lon, class: 'control-label' %>
      <%= f.text_field :lon, class: 'form-control input-lg', readonly: true %>
      </div>
    </div>
  </div>
</div>
<% end %>
